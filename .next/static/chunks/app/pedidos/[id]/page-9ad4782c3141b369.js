(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[483],{2884:function(e,s,t){Promise.resolve().then(t.bind(t,2060))},2060:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return p}});var a=t(7437),l=t(2265),n=t(7138),r=t(5137),i=t(3480);/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,i.Z)("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),d=(0,i.Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var o=t(7524),x=t(1077),m=t(2513);/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,i.Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var u=t(6463);function p(){let{id:e}=(0,u.useParams)(),[s,t]=(0,l.useState)(null),[i,p]=(0,l.useState)(!0),[j,f]=(0,l.useState)(""),[g,N]=(0,l.useState)(!1),[b,v]=(0,l.useState)({amount:0,method:"EFECTIVO"}),y=async()=>{let s=await fetch("/api/orders/".concat(e));if(s.ok){let e=await s.json();t(e),f(e.status)}p(!1)};(0,l.useEffect)(()=>{e&&y()},[e]);let w=async()=>{await fetch("/api/orders/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:j})}),alert("Estado actualizado"),y()},k=async s=>{s.preventDefault(),await fetch("/api/orders/".concat(e,"/payment"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),N(!1),v({amount:0,method:"EFECTIVO"}),y()};return i?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Cargando pedido..."})]})}):s?(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-6 text-sm",children:[(0,a.jsxs)(n.default,{href:"/pedidos",className:"text-slate-500 hover:text-blue-600 transition-colors flex items-center gap-1",children:[(0,a.jsx)(r.Z,{className:"w-4 h-4"}),"Pedidos"]}),(0,a.jsx)("span",{className:"text-slate-400",children:"/"}),(0,a.jsxs)("span",{className:"text-slate-700 font-medium",children:["Pedido #",s.id.slice(0,8)]})]}),(0,a.jsx)("div",{className:"card p-6 mb-6",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between gap-6",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-slate-800 mb-2",children:s.customer.name}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm text-slate-600",children:[(0,a.jsxs)("span",{children:["\uD83D\uDCC5 ",new Date(s.orderDate).toLocaleDateString("es-AR",{day:"2-digit",month:"long",year:"numeric"})]}),(0,a.jsxs)("span",{className:"font-semibold",children:["\uD83D\uDCB5 Total: $",s.total.toLocaleString()]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsxs)(n.default,{href:"/pedidos/".concat(e,"/print"),className:"btn-secondary text-sm justify-center",children:[(0,a.jsx)(c,{className:"w-4 h-4"}),"Orden de Impresi\xf3n"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("select",{value:j,onChange:e=>f(e.target.value),className:"text-sm flex-1",children:[(0,a.jsx)("option",{value:"SOLICITADO",children:"Solicitado"}),(0,a.jsx)("option",{value:"EN_IMPRENTA",children:"En Imprenta"}),(0,a.jsx)("option",{value:"TERMINADO",children:"Terminado"}),(0,a.jsx)("option",{value:"ENTREGADO",children:"Entregado"})]}),(0,a.jsx)("button",{onClick:w,className:"btn-primary px-4",title:"Guardar estado",children:(0,a.jsx)(d,{className:"w-4 h-4"})})]})]})]})}),(0,a.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)(o.Z,{className:"w-5 h-5 text-blue-600"}),(0,a.jsx)("h3",{className:"font-bold text-xl text-slate-800",children:"Items del Pedido"})]}),(0,a.jsx)("div",{className:"space-y-3",children:s.items.map(e=>(0,a.jsx)("div",{className:"card p-5 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-bold text-lg text-slate-800 mb-1",children:e.product.internalName}),(0,a.jsxs)("div",{className:"space-y-1 text-sm text-slate-600",children:[e.product.measures&&(0,a.jsxs)("p",{children:["\uD83D\uDCCF ",e.product.measures]}),e.product.paperType&&(0,a.jsxs)("p",{children:["\uD83D\uDCC4 ",e.product.paperType]}),(0,a.jsxs)("p",{className:"font-semibold text-slate-700",children:["Cantidad: ",e.quantity.toLocaleString()," unidades"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-xs text-slate-500 mb-1",children:"Subtotal"}),(0,a.jsxs)("p",{className:"font-bold text-2xl text-blue-600",children:["$",e.subtotal.toLocaleString()]})]})]})},e.id))}),(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5 text-green-600"}),(0,a.jsx)("h3",{className:"font-bold text-xl text-slate-800",children:"Pagos Registrados"})]}),(0,a.jsxs)("button",{onClick:()=>N(!g),className:"text-sm font-medium text-green-600 hover:bg-green-50 px-3 py-1.5 rounded-lg transition-colors flex items-center gap-1",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4"}),"Registrar Pago"]})]}),g&&(0,a.jsxs)("form",{onSubmit:k,className:"card p-5 mb-4 bg-gradient-to-br from-green-50 to-emerald-50 border-green-200 animate-fade-in",children:[(0,a.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Monto a Pagar"}),(0,a.jsx)("input",{type:"number",step:"0.01",required:!0,value:b.amount,onChange:e=>v({...b,amount:parseFloat(e.target.value)}),placeholder:"0.00"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"M\xe9todo de Pago"}),(0,a.jsxs)("select",{value:b.method,onChange:e=>v({...b,method:e.target.value}),children:[(0,a.jsx)("option",{value:"EFECTIVO",children:"Efectivo"}),(0,a.jsx)("option",{value:"TRANSFERENCIA",children:"Transferencia"}),(0,a.jsx)("option",{value:"CHEQUE",children:"Cheque"}),(0,a.jsx)("option",{value:"TARJETA",children:"Tarjeta"})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>N(!1),className:"flex-1 btn-secondary",children:"Cancelar"}),(0,a.jsxs)("button",{type:"submit",className:"flex-1 bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[(0,a.jsx)(h,{className:"w-4 h-4"}),"Confirmar Pago"]})]})]}),0===s.payments.length?(0,a.jsxs)("div",{className:"text-center py-8 text-slate-400",children:[(0,a.jsx)(x.Z,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"Sin pagos registrados"})]}):(0,a.jsx)("div",{className:"space-y-2",children:s.payments.map(e=>(0,a.jsxs)("div",{className:"card p-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center",children:(0,a.jsx)(h,{className:"w-5 h-5 text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-slate-800",children:e.method}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:new Date(e.paymentDate).toLocaleDateString("es-AR",{day:"2-digit",month:"short",year:"numeric"})})]})]}),(0,a.jsxs)("span",{className:"font-bold text-xl text-green-600",children:["$",e.amount.toLocaleString()]})]},e.id))})]})]}),(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"card p-6 sticky top-4 bg-gradient-to-br from-slate-50 to-slate-100",children:[(0,a.jsx)("h3",{className:"text-slate-600 text-sm font-bold uppercase tracking-wide mb-6",children:"Resumen Financiero"}),(0,a.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center pb-3 border-b border-slate-200",children:[(0,a.jsx)("span",{className:"text-slate-600",children:"Total del Pedido"}),(0,a.jsxs)("span",{className:"font-bold text-lg text-slate-800",children:["$",s.total.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center pb-3 border-b border-slate-200",children:[(0,a.jsxs)("span",{className:"text-green-600 flex items-center gap-1",children:[(0,a.jsx)(h,{className:"w-4 h-4"}),"Pagado"]}),(0,a.jsxs)("span",{className:"font-bold text-lg text-green-600",children:["$",(s.total-s.balance).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center pt-2",children:[(0,a.jsx)("span",{className:"font-bold text-lg text-slate-800",children:"Saldo Pendiente"}),(0,a.jsxs)("span",{className:"text-3xl font-bold ".concat(s.balance>0?"text-red-600":"text-green-600"),children:["$",s.balance.toLocaleString()]})]})]}),s.balance>0?(0,a.jsxs)("div",{className:"bg-gradient-to-r from-red-500 to-red-600 text-white p-4 rounded-xl text-center shadow-lg",children:[(0,a.jsx)("p",{className:"text-sm opacity-90 mb-1",children:"Estado de Pago"}),(0,a.jsx)("p",{className:"font-bold text-lg",children:"Pendiente de Cobro"})]}):(0,a.jsxs)("div",{className:"bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-xl text-center shadow-lg",children:[(0,a.jsx)(h,{className:"w-8 h-8 mx-auto mb-2"}),(0,a.jsx)("p",{className:"font-bold text-lg",children:"Pagado Completamente"})]}),(0,a.jsx)("div",{className:"mt-6 pt-6 border-t border-slate-200",children:(0,a.jsxs)("div",{className:"space-y-2 text-sm text-slate-600",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Items:"}),(0,a.jsx)("span",{className:"font-semibold",children:s.items.length})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Pagos:"}),(0,a.jsx)("span",{className:"font-semibold",children:s.payments.length})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Estado:"}),(0,a.jsx)("span",{className:"font-semibold",children:j})]})]})})]})})]})]}):(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)("p",{className:"text-slate-600 text-lg",children:"Pedido no encontrado"}),(0,a.jsx)(n.default,{href:"/pedidos",className:"text-blue-600 hover:underline mt-4 inline-block",children:"Volver a pedidos"})]})}},3480:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});var a=t(2265),l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r=(e,s)=>{let t=(0,a.forwardRef)((t,r)=>{let{color:i="currentColor",size:c=24,strokeWidth:d=2,absoluteStrokeWidth:o,className:x="",children:m,...h}=t;return(0,a.createElement)("svg",{ref:r,...l,width:c,height:c,stroke:i,strokeWidth:o?24*Number(d)/Number(c):d,className:["lucide","lucide-".concat(n(e)),x].join(" "),...h},[...s.map(e=>{let[s,t]=e;return(0,a.createElement)(s,t)}),...Array.isArray(m)?m:[m]])});return t.displayName="".concat(e),t}},5137:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(3480).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1077:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(3480).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},7524:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(3480).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},2513:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(3480).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7138:function(e,s,t){"use strict";t.d(s,{default:function(){return l.a}});var a=t(231),l=t.n(a)},6463:function(e,s,t){"use strict";var a=t(1169);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})}},function(e){e.O(0,[231,971,23,744],function(){return e(e.s=2884)}),_N_E=e.O()}]);