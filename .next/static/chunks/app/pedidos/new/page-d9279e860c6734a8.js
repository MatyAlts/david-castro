(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[121],{1630:function(e,t,s){Promise.resolve().then(s.bind(s,4948))},4948:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var a=s(7437),l=s(2265),n=s(6463),r=s(5137),c=s(2022),i=s(2513),d=s(7524);/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,s(3480).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var u=s(2023),h=s(8960);function x(){let e=(0,n.useRouter)(),[t,s]=(0,l.useState)([]),[x,m]=(0,l.useState)(""),[p,j]=(0,l.useState)([]),[f,N]=(0,l.useState)([]),[b,v]=(0,l.useState)(""),[g,y]=(0,l.useState)(!1);(0,l.useEffect)(()=>{fetch("/api/clientes").then(e=>e.json()).then(s)},[]),(0,l.useEffect)(()=>{x&&(fetch("/api/products?customerId=".concat(x)).then(e=>e.json()).then(j),N([]))},[x]);let k=(e,t,s)=>{N(a=>{let l=[...a];return"quantity"===t||"price"===t?l[e]={...l[e],[t]:Number(s)}:l[e]={...l[e],[t]:s},l})},w=e=>{N(f.filter((t,s)=>s!==e))},C=()=>f.reduce((e,t)=>e+t.quantity*t.price,0),Z=async()=>{x&&0!==f.length&&(y(!0),(await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerId:x,items:f,total:C(),notes:b})})).ok&&e.push("/pedidos"),y(!1))};return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-8",children:[(0,a.jsx)("button",{onClick:()=>e.back(),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:(0,a.jsx)(r.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"mb-1",children:"Nuevo Pedido"}),(0,a.jsx)("p",{className:"text-sm text-slate-600",children:"Crea una nueva orden de trabajo"})]})]}),(0,a.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-600 text-white flex items-center justify-center font-bold",children:"1"}),(0,a.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"Seleccionar Cliente"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c.Z,{className:"w-5 h-5 text-slate-400"}),(0,a.jsxs)("select",{className:"flex-1",value:x,onChange:e=>m(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"-- Seleccionar Cliente --"}),t.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),x&&(0,a.jsxs)("div",{className:"card p-6 animate-fade-in",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-600 text-white flex items-center justify-center font-bold",children:"2"}),(0,a.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"Items del Pedido"}),(0,a.jsxs)("button",{onClick:()=>{N([...f,{productId:"",quantity:100,price:0}])},className:"ml-auto text-blue-600 text-sm font-medium flex items-center gap-1 hover:bg-blue-50 px-3 py-1.5 rounded-lg transition-colors",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4"})," Agregar"]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[f.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-3 items-start p-4 rounded-xl border-2 border-slate-200 hover:border-blue-300 transition-colors bg-white",children:[(0,a.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 text-slate-400"}),(0,a.jsxs)("select",{className:"flex-1 text-sm",value:e.productId,onChange:e=>k(t,"productId",e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Seleccionar producto..."}),p.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.internalName," (",e.measures,")"]},e.id))]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-slate-600",children:"Cantidad"}),(0,a.jsx)("input",{type:"number",placeholder:"100",className:"w-full text-sm",value:e.quantity,onChange:e=>k(t,"quantity",e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-slate-600",children:"Precio Unitario"}),(0,a.jsx)("input",{type:"number",step:"0.01",placeholder:"0.00",className:"w-full text-sm",value:e.price,onChange:e=>k(t,"price",e.target.value)})]})]}),e.quantity>0&&e.price>0&&(0,a.jsxs)("div",{className:"text-right text-sm",children:[(0,a.jsx)("span",{className:"text-slate-600",children:"Subtotal: "}),(0,a.jsxs)("span",{className:"font-bold text-slate-800",children:["$",(e.quantity*e.price).toLocaleString()]})]})]}),(0,a.jsx)("button",{onClick:()=>w(t),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:(0,a.jsx)(o,{className:"w-5 h-5"})})]},t)),0===f.length&&(0,a.jsxs)("div",{className:"text-center py-8 text-slate-400",children:[(0,a.jsx)(d.Z,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"Agrega productos al pedido"})]})]})]}),x&&f.length>0&&(0,a.jsxs)("div",{className:"card p-6 animate-fade-in",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-600 text-white flex items-center justify-center font-bold",children:"3"}),(0,a.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"Observaciones"})]}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5 text-slate-400 mt-2"}),(0,a.jsx)("textarea",{rows:4,value:b,onChange:e=>v(e.target.value),placeholder:"Detalles adicionales, instrucciones especiales...",className:"flex-1"})]})]})]}),(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"card p-6 sticky top-4",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-4 text-slate-800",children:"Resumen"}),(0,a.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-slate-600",children:"Items:"}),(0,a.jsx)("span",{className:"font-semibold",children:f.length})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-slate-600",children:"Unidades:"}),(0,a.jsx)("span",{className:"font-semibold",children:f.reduce((e,t)=>e+t.quantity,0).toLocaleString()})]}),(0,a.jsx)("div",{className:"border-t pt-3",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"font-bold text-slate-800",children:"Total:"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-blue-600",children:["$",C().toLocaleString()]})]})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("button",{disabled:!x||0===f.length||g,onClick:Z,className:"w-full btn-primary justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Creando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{className:"w-4 h-4"}),"Confirmar Pedido"]})}),(0,a.jsx)("button",{onClick:()=>e.back(),className:"w-full btn-secondary justify-center",children:"Cancelar"})]})]})})]})]})}},3480:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2265),l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r=(e,t)=>{let s=(0,a.forwardRef)((s,r)=>{let{color:c="currentColor",size:i=24,strokeWidth:d=2,absoluteStrokeWidth:o,className:u="",children:h,...x}=s;return(0,a.createElement)("svg",{ref:r,...l,width:i,height:i,stroke:c,strokeWidth:o?24*Number(d)/Number(i):d,className:["lucide","lucide-".concat(n(e)),u].join(" "),...x},[...t.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(h)?h:[h]])});return s.displayName="".concat(e),s}},5137:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(3480).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},2023:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(3480).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},7524:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(3480).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},2513:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(3480).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},8960:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(3480).Z)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},2022:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(3480).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},6463:function(e,t,s){"use strict";var a=s(1169);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})}},function(e){e.O(0,[971,23,744],function(){return e(e.s=1630)}),_N_E=e.O()}]);